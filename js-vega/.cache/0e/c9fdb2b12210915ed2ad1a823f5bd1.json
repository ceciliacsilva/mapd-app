{"id":"node_modules/vega-transform-omnisci-core/build/vega-transform-omnisci-core.umd.js","dependencies":[{"name":"/home/cecilia/prjs/mapD/mapd-app/js-vega/node_modules/vega-transform-omnisci-core/build/vega-transform-omnisci-core.umd.js.map","includedInParent":true,"mtime":499162500000},{"name":"/home/cecilia/prjs/mapD/mapd-app/js-vega/package.json","includedInParent":true,"mtime":1570038368562},{"name":"/home/cecilia/prjs/mapD/mapd-app/js-vega/node_modules/vega-transform-omnisci-core/package.json","includedInParent":true,"mtime":1570038419471},{"name":"vega","loc":{"line":1,"column":93},"parent":"/home/cecilia/prjs/mapD/mapd-app/js-vega/node_modules/vega-transform-omnisci-core/build/vega-transform-omnisci-core.umd.js","resolved":"/home/cecilia/prjs/mapD/mapd-app/js-vega/node_modules/vega/index.js"}],"generated":{"js":"var define;\n!function(e,r){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=r(require(\"vega\")):\"function\"==typeof define&&define.amd?define([\"vega\"],r):e.QueryCore=r(e.vega)}(this,function(e){function r(r){e.Transform.call(this,[],r)}return r.session=function(e){return e?(this._session=e,this):this._session},r.Definition={type:\"QueryCore\",metadata:{changes:!0,source:!0},params:[{name:\"query\",type:\"string\",required:!0}]},e.inherits(r,e.Transform).transform=function(s,n){try{var i=this;if(!r._session)throw Error(\"OmniSci Core session missing. Please assign it to the vega transform by calling `QueryCore.session(session).`\");return Promise.resolve(r._session.queryAsync(s.query)).then(function(r){r.forEach(e.ingest);var s=n.fork(n.NO_FIELDS&n.NO_SOURCE);return s.rem=i.value,i.value=s.add=s.source=r,s})}catch(e){return Promise.reject(e)}},r});\n\n"},"sourceMaps":{"js":{"mappings":[{"source":"../index.js","name":null,"original":{"line":9,"column":15},"generated":{"line":2,"column":199}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":208}},{"source":"../index.js","name":"params","original":{"line":9,"column":34},"generated":{"line":2,"column":210}},{"source":"../index.js","name":"Transform","original":{"line":10,"column":2},"generated":{"line":2,"column":213}},{"source":"../index.js","name":"call","original":{"line":10,"column":12},"generated":{"line":2,"column":225}},{"source":"../index.js","name":"this","original":{"line":10,"column":17},"generated":{"line":2,"column":230}},{"source":"../index.js","name":null,"original":{"line":10,"column":23},"generated":{"line":2,"column":235}},{"source":"../index.js","name":"params","original":{"line":10,"column":27},"generated":{"line":2,"column":238}},{"source":"../index.js","name":"QueryCore","original":{"line":13,"column":0},"generated":{"line":2,"column":248}},{"source":"../index.js","name":"session","original":{"line":13,"column":10},"generated":{"line":2,"column":250}},{"source":"../index.js","name":null,"original":{"line":13,"column":20},"generated":{"line":2,"column":258}},{"source":"../index.js","name":"session","original":{"line":13,"column":29},"generated":{"line":2,"column":267}},{"source":"../index.js","name":"session","original":{"line":14,"column":6},"generated":{"line":2,"column":277}},{"source":"../index.js","name":"_session","original":{"line":15,"column":9},"generated":{"line":2,"column":285}},{"source":"../index.js","name":"session","original":{"line":15,"column":20},"generated":{"line":2,"column":294}},{"source":"../index.js","name":"this","original":{"line":16,"column":11},"generated":{"line":2,"column":296}},{"source":"../index.js","name":"this","original":{"line":19,"column":9},"generated":{"line":2,"column":302}},{"source":"../index.js","name":"_session","original":{"line":19,"column":14},"generated":{"line":2,"column":307}},{"source":"../index.js","name":"QueryCore","original":{"line":22,"column":0},"generated":{"line":2,"column":317}},{"source":"../index.js","name":"Definition","original":{"line":22,"column":10},"generated":{"line":2,"column":319}},{"source":"../index.js","name":null,"original":{"line":22,"column":23},"generated":{"line":2,"column":330}},{"source":"../index.js","name":"type","original":{"line":23,"column":2},"generated":{"line":2,"column":331}},{"source":"../index.js","name":null,"original":{"line":23,"column":8},"generated":{"line":2,"column":336}},{"source":"../index.js","name":"metadata","original":{"line":24,"column":2},"generated":{"line":2,"column":348}},{"source":"../index.js","name":null,"original":{"line":24,"column":12},"generated":{"line":2,"column":357}},{"source":"../index.js","name":"changes","original":{"line":24,"column":14},"generated":{"line":2,"column":358}},{"source":"../index.js","name":null,"original":{"line":24,"column":23},"generated":{"line":2,"column":367}},{"source":"../index.js","name":"source","original":{"line":24,"column":29},"generated":{"line":2,"column":369}},{"source":"../index.js","name":null,"original":{"line":24,"column":37},"generated":{"line":2,"column":377}},{"source":"../index.js","name":"params","original":{"line":25,"column":2},"generated":{"line":2,"column":380}},{"source":"../index.js","name":null,"original":{"line":25,"column":10},"generated":{"line":2,"column":387}},{"source":"../index.js","name":null,"original":{"line":25,"column":11},"generated":{"line":2,"column":388}},{"source":"../index.js","name":"name","original":{"line":25,"column":13},"generated":{"line":2,"column":389}},{"source":"../index.js","name":null,"original":{"line":25,"column":19},"generated":{"line":2,"column":394}},{"source":"../index.js","name":"type","original":{"line":25,"column":28},"generated":{"line":2,"column":402}},{"source":"../index.js","name":null,"original":{"line":25,"column":34},"generated":{"line":2,"column":407}},{"source":"../index.js","name":"required","original":{"line":25,"column":44},"generated":{"line":2,"column":416}},{"source":"../index.js","name":null,"original":{"line":25,"column":54},"generated":{"line":2,"column":426}},{"source":"../index.js","name":"inherits","original":{"line":28,"column":18},"generated":{"line":2,"column":431}},{"source":"../index.js","name":"QueryCore","original":{"line":28,"column":27},"generated":{"line":2,"column":442}},{"source":"../index.js","name":"Transform","original":{"line":28,"column":38},"generated":{"line":2,"column":444}},{"source":"../index.js","name":"transform","original":{"line":30,"column":10},"generated":{"line":2,"column":457}},{"source":"../index.js","name":"_","original":{"line":30,"column":37},"generated":{"line":2,"column":476}},{"source":"../index.js","name":"pulse","original":{"line":30,"column":40},"generated":{"line":2,"column":478}},{"source":"../index.js","name":"this","original":{"line":42,"column":12},"generated":{"line":2,"column":491}},{"source":"../index.js","name":"QueryCore","original":{"line":31,"column":9},"generated":{"line":2,"column":500}},{"source":"../index.js","name":"_session","original":{"line":31,"column":19},"generated":{"line":2,"column":502}},{"source":"../index.js","name":"Error","original":{"line":32,"column":10},"generated":{"line":2,"column":517}},{"source":"../index.js","name":null,"original":{"line":33,"column":6},"generated":{"line":2,"column":523}},{"source":"../index.js","name":"QueryCore","original":{"line":37,"column":23},"generated":{"line":2,"column":659}},{"source":"../index.js","name":"_session","original":{"line":37,"column":33},"generated":{"line":2,"column":661}},{"source":"../index.js","name":"queryAsync","original":{"line":37,"column":42},"generated":{"line":2,"column":670}},{"source":"../index.js","name":"_","original":{"line":37,"column":53},"generated":{"line":2,"column":681}},{"source":"../index.js","name":"query","original":{"line":37,"column":55},"generated":{"line":2,"column":683}},{"source":"../index.js","name":"result","original":{"line":37,"column":8},"generated":{"line":2,"column":705}},{"source":"../index.js","name":"result","original":{"line":39,"column":2},"generated":{"line":2,"column":708}},{"source":"../index.js","name":"forEach","original":{"line":39,"column":9},"generated":{"line":2,"column":710}},{"source":"../index.js","name":"ingest","original":{"line":39,"column":17},"generated":{"line":2,"column":718}},{"source":"../index.js","name":"out","original":{"line":41,"column":8},"generated":{"line":2,"column":732}},{"source":"../index.js","name":"pulse","original":{"line":41,"column":14},"generated":{"line":2,"column":734}},{"source":"../index.js","name":"fork","original":{"line":41,"column":20},"generated":{"line":2,"column":736}},{"source":"../index.js","name":"pulse","original":{"line":41,"column":25},"generated":{"line":2,"column":741}},{"source":"../index.js","name":"NO_FIELDS","original":{"line":41,"column":31},"generated":{"line":2,"column":743}},{"source":"../index.js","name":"pulse","original":{"line":41,"column":43},"generated":{"line":2,"column":753}},{"source":"../index.js","name":"NO_SOURCE","original":{"line":41,"column":49},"generated":{"line":2,"column":755}},{"source":"../index.js","name":"out","original":{"line":42,"column":2},"generated":{"line":2,"column":773}},{"source":"../index.js","name":"rem","original":{"line":42,"column":6},"generated":{"line":2,"column":775}},{"source":"../index.js","name":"_this","original":{"line":42,"column":12},"generated":{"line":2,"column":779}},{"source":"../index.js","name":"value","original":{"line":42,"column":17},"generated":{"line":2,"column":781}},{"source":"../index.js","name":"value","original":{"line":43,"column":7},"generated":{"line":2,"column":789}},{"source":"../index.js","name":"out","original":{"line":43,"column":15},"generated":{"line":2,"column":795}},{"source":"../index.js","name":"add","original":{"line":43,"column":19},"generated":{"line":2,"column":797}},{"source":"../index.js","name":"out","original":{"line":43,"column":25},"generated":{"line":2,"column":801}},{"source":"../index.js","name":"source","original":{"line":43,"column":29},"generated":{"line":2,"column":803}},{"source":"../index.js","name":"result","original":{"line":43,"column":38},"generated":{"line":2,"column":810}},{"source":"../index.js","name":"out","original":{"line":45,"column":9},"generated":{"line":2,"column":812}}],"sources":{"../index.js":"import { inherits, ingest, Transform } from \"vega\";\n\n/**\n * Generates a function to query data from an OmniSci Core database.\n * @constructor\n * @param {object} params - The parameters for this operator.\n * @param {function(object): *} params.query - The SQL query.\n */\nexport default function QueryCore(params) {\n  Transform.call(this, [], params);\n}\n\nQueryCore.session = function(session) {\n  if (session) {\n    this._session = session;\n    return this;\n  }\n\n  return this._session;\n};\n\nQueryCore.Definition = {\n  type: \"QueryCore\",\n  metadata: { changes: true, source: true },\n  params: [{ name: \"query\", type: \"string\", required: true }]\n};\n\nconst prototype = inherits(QueryCore, Transform);\n\nprototype.transform = async function(_, pulse) {\n    if (!QueryCore._session) {\n    throw Error(\n      \"OmniSci Core session missing. Please assign it to the vega transform by calling `QueryCore.session(session).`\"\n    );\n  }\n\n  const result = await QueryCore._session.queryAsync(_.query);\n\n  result.forEach(ingest);\n\n  const out = pulse.fork(pulse.NO_FIELDS & pulse.NO_SOURCE);\n  out.rem = this.value;\n  this.value = out.add = out.source = result;\n\n  return out;\n};\n"},"lineCount":null}},"error":null,"hash":"60e5c11f0659d3001b1ff63f0b79c515","cacheData":{"env":{}}}